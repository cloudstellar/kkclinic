# Sprint 5: Staff Workflow & Audit Trail

**Status:** Planning  
**Date:** 2025-01-25  
**Depends on:** Sprint 4 (Adjustment), ADR-0003 (RBAC)

---

## Real World Flow (à¸—à¸µà¹ˆà¸£à¸°à¸šà¸šà¸—à¸³à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§)

```
1. à¸«à¸¡à¸­à¸ªà¸£à¹‰à¸²à¸‡ Rx
2. à¸«à¸¡à¸­à¸à¸” "à¸Šà¸³à¸£à¸°" (= à¸ªà¸£à¸¸à¸›à¹€à¸„à¸ª, à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¸£à¸±à¸šà¹€à¸‡à¸´à¸™à¸ˆà¸£à¸´à¸‡)
3. à¸«à¸¡à¸­à¸à¸´à¸¡à¸à¹Œà¹ƒà¸šà¹€à¸ªà¸£à¹‡à¸ˆ+à¸‰à¸¥à¸²à¸ (à¸ªà¹ˆà¸‡à¹ƒà¸«à¹‰ staff)
4. Stock à¸•à¸±à¸” à¸“ à¸ˆà¸¸à¸”à¸™à¸µà¹‰
5. Staff à¹€à¸à¹‡à¸šà¹€à¸‡à¸´à¸™à¸ˆà¸£à¸´à¸‡à¸ˆà¸²à¸à¸„à¸™à¹„à¸‚à¹‰
6. à¸–à¹‰à¸²à¸„à¸™à¹„à¸‚à¹‰à¸„à¸·à¸™à¸¢à¸² â†’ Staff adjust â†’ Stock à¸„à¸·à¸™
```

**à¸£à¸°à¸šà¸šà¸—à¸³à¸–à¸¹à¸à¹à¸¥à¹‰à¸§ â€” à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¹à¸„à¹ˆ UI naming à¹ƒà¸«à¹‰à¸•à¸£à¸‡ real world**

---

## Goals (Locked)

1. `/frontdesk` = Staff default landing
2. Tab naming: "à¸£à¸­à¸ªà¸£à¸¸à¸›à¹€à¸„à¸ª" / "à¸ªà¸£à¸¸à¸›à¹€à¸„à¸ªà¹à¸¥à¹‰à¸§"
3. Staff à¹„à¸¡à¹ˆà¹€à¸«à¹‡à¸™ `/billing`
4. Void = Admin/Doctor only
5. à¸«à¸™à¹‰à¸² Rx à¸¡à¸µ "à¸›à¸£à¸°à¸§à¸±à¸•à¸´"

---

## Phase 1: Done (Sprint 4.5)

- [x] A1: Adjust â†’ dropdown menu
- [x] B2: Void = Admin/Doctor only

---

## Phase 2: `/frontdesk` Route

### 2.1 Create `/frontdesk`

**File:** `app/(dashboard)/frontdesk/page.tsx`

```
/frontdesk
â”œâ”€â”€ Card 1: à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢
â”‚   â”œâ”€â”€ à¸„à¹‰à¸™à¸«à¸²à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢
â”‚   â””â”€â”€ â• à¹€à¸à¸´à¹ˆà¸¡à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢à¹ƒà¸«à¸¡à¹ˆ
â”‚
â”œâ”€â”€ Card 2: à¸‡à¸²à¸™à¸§à¸±à¸™à¸™à¸µà¹‰
â”‚   â”œâ”€â”€ Tab: à¸£à¸­à¸ªà¸£à¸¸à¸›à¹€à¸„à¸ª
â”‚   â”‚     (prescriptions à¸—à¸µà¹ˆà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µ transaction)
â”‚   â”‚     - à¹à¸ªà¸”à¸‡ Rx à¸—à¸µà¹ˆà¸«à¸¡à¸­à¸ªà¸£à¹‰à¸²à¸‡à¹à¸¥à¹‰à¸§à¹à¸•à¹ˆà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸à¸” "à¸Šà¸³à¸£à¸°"
â”‚   â”‚
â”‚   â””â”€â”€ Tab: à¸ªà¸£à¸¸à¸›à¹€à¸„à¸ªà¹à¸¥à¹‰à¸§ â† Staff à¸—à¸³à¸‡à¸²à¸™à¸«à¸¥à¸±à¸à¸—à¸µà¹ˆà¸™à¸µà¹ˆ
â”‚         (transactions à¸§à¸±à¸™à¸™à¸µà¹‰)
â”‚         - à¹à¸ªà¸”à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸—à¸µà¹ˆà¸«à¸¡à¸­à¸à¸”à¹à¸¥à¹‰à¸§
â”‚         - Staff à¸£à¸­à¹€à¸à¹‡à¸šà¹€à¸‡à¸´à¸™ / adjust à¹„à¸”à¹‰
â”‚         - à¸à¸” â†’ à¹„à¸›à¸«à¸™à¹‰à¸² receipt
â”‚
â””â”€â”€ âŒ à¹„à¸¡à¹ˆà¸¡à¸µà¸¢à¸­à¸”à¸ªà¸£à¸¸à¸›
```

**Est:** 2h

### 2.2 Block `/billing` for Staff

```tsx
if (userRole === 'staff') redirect('/frontdesk')
```

+ à¸‹à¹ˆà¸­à¸™à¹€à¸¡à¸™à¸¹ billing à¹ƒà¸™ nav

**Est:** 30m

### 2.3 Staff Default Landing

```tsx
// After login
if (userRole === 'staff') redirect('/frontdesk')
```

**Est:** 15m

---

## Phase 3: Rx History (Audit Trail)

**File:** `app/(dashboard)/prescriptions/[id]/page.tsx`

```tsx
<Card>
  <CardHeader>ğŸ“‹ à¸›à¸£à¸°à¸§à¸±à¸•à¸´</CardHeader>
  <CardContent>
    âœ… à¸ªà¸£à¸¸à¸›à¹€à¸„à¸ª: 25 à¸¡.à¸„. 68 10:30 | RCP250125-001
    ğŸ”§ à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡ #1: 25 à¸¡.à¸„. 68 11:00 | Staff | à¸¿500 â†’ à¸¿400
    âŒ à¸¢à¸à¹€à¸¥à¸´à¸: 25 à¸¡.à¸„. 68 12:00 | Doctor | "à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢à¹„à¸¡à¹ˆà¸£à¸±à¸šà¸¢à¸²"
  </CardContent>
</Card>
```

**Est:** 1.5h

---

## Implementation Order

| # | Task | Est | Status |
|---|------|-----|--------|
| 1 | Adjust â†’ dropdown | 30m | âœ… |
| 2 | Void guard | 30m | âœ… |
| 3 | Create `/frontdesk` | 2h | â¬œ |
| 4 | Block `/billing` + nav | 30m | â¬œ |
| 5 | Staff default landing | 15m | â¬œ |
| 6 | Rx history | 1.5h | â¬œ |

**Total:** ~5h

---

## Acceptance Criteria

- [ ] Staff à¹€à¸‚à¹‰à¸² `/billing` â†’ redirect `/frontdesk`
- [ ] Staff à¹„à¸¡à¹ˆà¹€à¸«à¹‡à¸™à¹€à¸¡à¸™à¸¹ `/billing`
- [ ] Staff void à¹„à¸¡à¹ˆà¹„à¸”à¹‰ âœ…
- [ ] Tab naming: "à¸£à¸­à¸ªà¸£à¸¸à¸›à¹€à¸„à¸ª" / "à¸ªà¸£à¸¸à¸›à¹€à¸„à¸ªà¹à¸¥à¹‰à¸§"
- [ ] `/frontdesk` à¸¡à¸µ: à¸„à¹‰à¸™à¸«à¸²à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢ + à¹€à¸à¸´à¹ˆà¸¡à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢ + 2 tabs
- [ ] à¸«à¸™à¹‰à¸² Rx à¹à¸ªà¸”à¸‡à¸›à¸£à¸°à¸§à¸±à¸•à¸´
